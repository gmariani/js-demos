var cv=cv||{};cv.controls=cv.controls||{};cv.controls.Slider=function(element,options){function hOP(n,v,d){return opt.hasOwnProperty(n)?v:d}var _=this,eventList=["focus","blur","change","init","destroy"],aEL=cv.addEventListener,rEL=cv.removeEventListener,lbl,i,opt=options||{},vertical=hOP("vertical",!!opt.vertical,false),arrowsEnabled=hOP("arrows",!!opt.arrows,false),barEnabled=hOP("bar",!!opt.bar,false);_.increment=hOP("increment",+opt.increment,5);_.maxIncrement=hOP("maxIncrement",+opt.maxIncrement,(_.increment*2));_.mouseWheelEnabled=hOP("mouseWheel",!!opt.mouseWheel,true);_.src=element;_.srcTag=element.tagName.toLowerCase();_.max=hOP("max",+opt.max,1);_.min=hOP("min",+opt.min,1);_.snapEnabled=hOP("snap",!!opt.snap,false);_.tweenEnabled=hOP("tween",!!opt.tween,false);_.tweenUpdateEnabled=hOP("tweenUpdate",!!opt.tweenUpdate,false);_.jumpEnabled=hOP("jump",!!opt.jump,false);_.minPx=0;_._position=0;_._callbacks={};for(i=0;i<eventList.length;i++){_._callbacks[eventList[i]]=[]}_.slider=document.createElement("div");_.slider.className="cv-slider"+(vertical?"-vertical ":" ");_.slider.id="cv-slider-"+_.src.id;aEL(_.slider,"mouseover",sliderHandler);aEL(_.slider,"mouseout",sliderHandler);aEL(_.slider,"mousedown",sliderHandler);_.track=document.createElement("div");_.track.className="cv-slider-track";if(barEnabled){_.innerBar=document.createElement("span");_.innerBar.className="cv-slider-bar"}if(arrowsEnabled){_.leftBtn=document.createElement("span");_.leftBtn.className="cv-slider-left";aEL(_.leftBtn,"mousedown",leftHandler)}if(arrowsEnabled){_.rightBtn=document.createElement("span");_.rightBtn.className="cv-slider-right";aEL(_.rightBtn,"mousedown",rightHandler)}_.thumb=document.createElement("span");_.thumb.setAttribute(!/*@cc_on!@*/false?"tabIndex":"tabindex","0");_.thumb.className="cv-slider-thumb";_.thumb.id="cv-slider-thumb-"+_.src.id;lbl=findLabel();if(lbl){_.thumb.setAttribute("aria-labelledby",lbl.id);if(window.ActiveXObject){lbl.setAttribute("htmlFor",_.thumb.id)}else{lbl.setAttribute("for",_.thumb.id)}}_.thumb.setAttribute("role","slider");_.thumb.setAttribute("aria-valuemin",0);_.thumb.setAttribute("aria-valuemax",1);_.thumb.appendChild(document.createTextNode(String.fromCharCode(160)));if(!window.opera){aEL(_.thumb,"keydown",thumbHandler);aEL(_.thumb,"keypress",thumbHandler)}else{aEL(_.thumb,"keypress",thumbHandler)}aEL(_.thumb,"mousedown",thumbHandler);aEL(_.thumb,"focus",thumbHandler);aEL(_.thumb,"blur",thumbHandler);_.slider.appendChild(_.track);if(_.innerBar){_.track.appendChild(_.innerBar)}if(_.leftBtn){_.track.appendChild(_.leftBtn)}if(_.rightBtn){_.track.appendChild(_.rightBtn)}_.track.appendChild(_.thumb);_.src.parentNode.insertBefore(_.slider,_.src);if(!!opt.hideInput){_.src.className+=" cv-slider-input"}else{aEL(_.src,"change",sourceHandler)}if(arrowsEnabled){_.minPx+=_.leftBtn.scrollWidth}_.totalPx=_.track.scrollWidth-(_.rightBtn?_.rightBtn.scrollWidth:0)-_.minPx-_.thumb.scrollWidth;_.maxPx=_.totalPx+(_.thumb.scrollWidth/2);if(_.slider.unselectable){_.thumb.unselectable="on";if(_.innerBar){_.innerBar.unselectable="on"}if(_.leftBtn){_.leftBtn.unselectable="on"}if(_.rightBtn){_.rightBtn.unselectable="on"}_.track.unselectable="on";_.slider.unselectable="on"}function stopEvent(e){e.stopPropagation();e.preventDefault()}function findLabel(){var lbl,src=_.src,labelList=document.getElementsByTagName("label"),i=labelList.length,l;if(src.parentNode&&src.parentNode.tagName.toLowerCase()==="label"){lbl=src.parentNode}else{while(i--){l=labelList[i];if((l.htmlFor&&l.htmlFor===src.id)||l.getAttribute("for")===src.id){lbl=l;break}}}if(lbl&&!lbl.id){lbl.id=src.id+"_label"}return lbl}function sourceHandler(e){_.setValue(_.getValue())}function leftHandler(e){stopEvent(e);_.setPosition(_.getPosition()-getIncrement())}function rightHandler(e){stopEvent(e);_.setPosition(_.getPosition()+getIncrement())}function thumbHandler(e){var kc,delta,value;switch(e.type){case"mousedown":e.preventDefault();aEL(document,"mousemove",thumbHandler);aEL(document,"mouseup",thumbHandler);return false;case"mouseup":rEL(document,"mousemove",thumbHandler);rEL(document,"mouseup",thumbHandler);break;case"mousemove":_.setPosition(e.pageX-_.track.offsetLeft);return false;case"focus":_.track.className=_.track.className.replace("cv-slider-focus","")+" cv-slider-focus";if(_.mouseWheelEnabled){aEL(window,"DOMMouseScroll",thumbHandler);aEL(document,"mousewheel",thumbHandler);if(!window.opera){aEL(window,"mousewheel",thumbHandler)}}_.callBack("focus");break;case"blur":_.track.className=_.track.className.replace("cv-slider-focus","");if(_.mouseWheelEnabled){rEL(document,"mousewheel",thumbHandler);rEL(window,"DOMMouseScroll",thumbHandler);if(!window.opera){rEL(window,"mousewheel",thumbHandler)}}_.callBack("blur");break;case"DOMMouseScroll":case"mousewheel":delta=e.scrollDelta||0;if(vertical){delta=-delta}if(delta!==0){_.setPosition(_.getPosition()+(getIncrement()*delta))}stopEvent(e);break;case"keydown":kc=e.keyCode;if(kc<33||(kc>40&&(kc!==45&&kc!==46))){return true}value=_.getPosition();if(kc===37||kc===40||kc===46||kc===34){value-=(e.ctrlKey||kc===34?getIncrement(_.maxIncrement):getIncrement())}else{if(kc===39||kc===38||kc===45||kc===33){value+=(e.ctrlKey||kc===33?getIncrement(_.maxIncrement):getIncrement())}else{if(kc===35){value=_.maxPx}else{if(kc===36){value=_.minPx}}}}_.setPosition(value);break;case"keypress":if((e.keyCode>=33&&e.keyCode<=40)||e.keyCode===45||e.keyCode===46){stopEvent(e)}return true}}function sliderHandler(e){switch(e.type){case"mousedown":_.thumb.focus();if(_.jumpEnabled){_.setPosition(e.clientX-_.minPx)}break;case"mouseout":_.track.className=_.track.className.replace("cv-slider-hover","");break;case"mouseover":_.track.className=_.track.className.replace("cv-slider-hover","")+" cv-slider-hover";break}}function getIncrement(inc){return(_.srcTag==="select")?(_.maxPx/_.max):(inc||_.increment)}_.update();_.callBack("init")};cv.controls.Slider.VERSION=2;cv.controls.Slider.prototype={getPosition:function(){return this._position+this.minPx+(this.thumb.scrollWidth/2)},setPosition:function(a){var c=this,b=(c.srcTag==="select")?(c.maxPx/c.max):c.increment,d=a%b;if(c.snapEnabled){a+=(d&&d>=(b/2))?(b-d):(d*-1)}a-=c.minPx;a-=c.thumb.scrollWidth/2;if(a<0){a=0}if(a>c.totalPx){a=c.totalPx}if(!c.tweenEnabled){c.thumb.style.left=a+"px"}else{if(gs&&gs.TweenLite){gs.TweenLite.to(c.thumb,0.5,{left:+a,units:"px",onUpdate:c.tweenUpdateEnabled?c.update:null})}else{trace("Slider::setPosition : TweenLite not available for tweening. Please include TweenLite.js.")}}c.update()},getPercent:function(){return this._position/this.totalPx},setPercent:function(a){this.setPosition(this.totalPx*a)},getValue:function(){return this.srcTag==="input"?parseFloat(this.src.value):this.src.selectedIndex},setValue:function(a){var b=this;if(isNaN(a)||a<Math.min(b.min,b.max)){a=Math.min(b.min,b.max)}else{if(a>Math.max(b.min,b.max)){a=Math.max(b.min,b.max)}}b.setPercent(a/b.max)},update:function(){var a=this,c;a._position=parseFloat(a.thumb.style.left||0);c=a.getPercent()*a.max;c=isNaN(c)?a.min:c;if(a.srcTag==="select"){try{c=Math.ceil(c);if(a.src.selectedIndex===c){return}a.src.options[c].selected=true}catch(b){}}else{if(a.src.value===c){return}a.src.value=c}a.thumb.setAttribute("aria-valuenow",a.srcTag==="select"?a.src.options[a.src.selectedIndex].value:a.src.value);a.thumb.setAttribute("aria-valuetext",a.srcTag==="select"?a.src.options[a.src.selectedIndex].text:a.src.value);a.callBack("change")},callBack:function(b){var a,d,h=this.src,g={source:h,value:this.srcTag==="select"?h.options[h.selectedIndex].value:h.value,percent:this.getPercent(),position:this.getPosition()};try{for(a=0;d=this._callbacks[b][a];a++){d(g)}}catch(c){trace("Slider::callBack :",c)}},addCallBack:function(b,a){if(this._callbacks[b]){return this._callbacks[b].push(a)}return NaN},removeCallBack:function(d,b){if(this._callbacks[d]){var a=this._callbacks[d],c;if(a[b]){c=a.slice(b+1);a.length=b;a.push.apply(a,c);return true}else{return false}}return false}};